<!-- En este ejemplo se va a buscar una lista de productos
por REST haciendo get a /api/product  -->


<!-- En este elemento se va a listar los productos -->
<div id="productList">
</div>

<!-- Es el template que se va a utilizar para rellenar la lista
de productos -->
<script id="productTemplate" type="text/template">
<div class="prodContainer">
  <span class="prodName"></span>
  <span class="prodPrice"></span>
</div>
</script>

<!-- Se agrega la libreria de llamada a servicios Rest -->
<script src="js/RestApi.js"></script>

<!-- El programa -->
<script>
"use strict"

// contiene el template base como string
const template = document.getElementById("productTemplate").innerHTML

// Referecia al elemento que va a tener la lista de productos
const productsElm = document.getElementById("productList")

// Funcion util para borrar la lista de productos en el HTML
function emptyProductList(){
  while(productsElm.firstChild){
    productsElm.removeChild(productsElm.firstChild)
  }
}
// Recibe un objeto producto y le aplica el template. 
//   Por ultimo lo agrega al html
function addProduct(product){
  
  const div = document.createElement("div")
  div.innerHTML = template
  // va a buscar por clase "prodName" al template y remplaza el contenido
  div.querySelector(".prodName").innerText= product.nombre
  div.querySelector(".prodPrice").innerText= product.precio
  
  //lo agrega al final de la lista de productos
  productsElm.appendChild(div)
}

//realiza la llamada REST y carga el HTML
RestApi.get("/api/producto")
  .then((products)=>products.forEach(addProduct))
  .catch((err)=>alert("Error al traer los productos " + err))


</script>
